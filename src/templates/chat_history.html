{% extends "base.html" %}

{% block content %}



<div class="container" style="display: flex; height: 100vh; width: 100%">
    
    <div class="left-column" style="flex: 1; background-color: #e0e0e0; padding: 20px;">
    <h4>Conversations</h4>
    <div style="max-height: 90vh; overflow-y: scroll">{% for history in histories  %}
    <div style="margin-top: 0.75vh; font-size: 75%">
        <a href="/chat/{{history.id}}">{{history.date_created}}</a>
    </div>
    <div>
        {% if history.messages|length > 1 %}
            <a href="/chat/{{history.id}}.json">{{history.messages[1]['content']}}</a>
        {% else %}
            Empty conversation
        {% endif %}
    </div>
{% endfor %}</div>
        </div>

        <div class="right-column" style="flex: 2; padding: 20px; max-height: 90vh; overflow-y: scroll">
            <h1>Chat History</h1>
        {% if history %}
        <div style="margin-bottom: 1vh">
        {{history.date_created}}
        <a href="/chat/{{history.id}}.json">JSON</a>
        </div>

        <div style="max-height: 85vh; overflow-y: scroll" id="messages">
            {% for msg in history.messages %}
            {% if msg.role == 'assistant' and msg.content %}
                <div>{{msg.content_html}}</div>
            {% endif %}
            {% if msg.role == 'user' and msg.content %}
                <div style="font-size: 120%">{{msg.content}}</div>
            {% endif %}
            {% if msg.role == 'function' and msg.content_json %}
            {% for obj in msg.content_json %}
                {% if obj.IIIF %}
                    <a title="{{obj.TITLE or obj.TITLE_NL or obj.TITLE_DE}}" href="{{obj.URL}}" target="_new"><img src="{{obj.IIIF.replace('info.json', 'full/,200/0/default.jpg')}}"></a>
                {% endif %}
            {% endfor %}
            

            {% endif %}
            {% endfor %}
        </div>


        {% endif %}
        </div>
    </div>





{% endblock content %}